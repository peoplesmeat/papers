The Protection of Game Machines
A Study in 4 Parts

Introduction
People love games. Almost as soon as computers were developed scientists manipulated these early machines to play games on them. This love of gaming lead to the development of game arcades in the early 70’s and then to the development of home consoles like the Nintendo Entertainment System and it’s successors the Sony Playstation and Microsoft Xbox. 
All gaming manufacturers face the same problem; how to secure their systems against unauthorized use. This includes pirated knock-offs machines, pirated games, and in the case of home machines, running unauthorized code on their gaming hardware. How developers deal with this is a fascinating study in the use of computer encryption techniques to secure commodity computational hardware. 
The end result of the monetization of widely available computer equipment for gaming purposes is an ever increasing arms race between game machine developers and hacker end-users who would like to utilize cheap gaming systems for their own purposes. This paper discusses in-depth three security systems developed for use in gaming machines, the Capcom Playsystem (1 and 2), the Microsoft Xbox and the Microsoft Xbox 360, this last machine being one of the most highly protected pieces of computer equipment ever developed. 
History
Gaming was one of the first commercial enterprises that computational devices were employed.  Early on developers realized that market existed for short, fun experiences behind a joystick and a monitor. This first pinball machines, which were mechanically operated, started appearing in the 1930’s and set the stage for coin operated gaming devices. Then in the 1970’s the computational revolution brought about the first coin operated arcade games. These games were developed in the spirit of early pinball and carnival games but quickly started appearing in bars, restaurants and movie theaters. Games like Donkey Kong and Pac-Man created a popular market for the machines and they started to appear in number. 
The early period of arcade games, sometime referred to as the Golden Age of Arcade Games,  was ushered in by these early arcade games and followed by smash arcade hits like Street Fighter 2, Mortal Kombat and NFL Blitz. The development of arcade games was driven in large part by the cost of the hardware on which they ran. In the 1970’s and 1980’s computers were expensive, especially computers powerful enough to show graphics and play games. A single arcade machine might cost several thousand dollars. In order to make these economically viable it was required that they be used in arcades and effectively time-shared amongst the gaming audience. 
In the mid-1980’s cost-effective 8-bit computer platforms were being developed, including the MOS Technology 6502 and the Zilog Z80. The components were able to bring down the cost of computing hardware enough so that home gaming machines became cost effective. The first break-through device capable of running arcade quality games was the Nintendo Entertainment System (NES) which made use of the 6502 to provide gamers the capability to purchase game cartridges that cost $50 instead of thousands. 
The growth of the home market signaled the end of the development of arcade machines. The successors to the NES, the Sega Genesis and the Super Nintendo used 16-bit processors like the Motorola 68000 and the Ricoh 5A22 and were significantly more able to deliver arcade quality gaming to home users. In face many arcade games, like Street Fighter 2, Altered Beast and AfterBurner, were ported to run on these home systems. Arcade machines of the time were still more advanced than their home counterparts, however the lead was shrinking, and it was clear at the time that it with several years home machines would be more capable then the arcade machines they were replacing. 
The introduction of the Sega Saturn in May 1995 brought about the first home system to use the compact disc format instead of custom game cartridges. The significantly more popular Sony Playstation also used compact discs and has sold over 100 million units. Innovation in these systems has widely decreased and been replaced by a hardware replacement cycle which replaces game consoles with systems that are largely identical but contain more powerful hardware. This is also evidenced by the lack of imagination in their names. The Sony Playstation was replaced by the Playstation 2, which was then replaced by the not-so-surprisingly named Playstation 3. Microsoft entered the market in 2001 with the introduction of the Xbox. The follow on to this device, the Xbox 360, was introduced 2005. 
The Capcom Play System
Capcom was an early producer of arcade game machines.  Their first title Vulgus, while not a smash hit, did allow them to continue to produce arcade machines leading to one of the most successful arcade games ever made, and certainly the largest franchise in arcade games, Street Fighter II. 
Early arcade hardware consisted of large amounts of custom equipment. Because there was no standard controller, board or monitor, ever manufacturer was required to develop the hardware which ultimately would run their game. Donkey Kong, for example,  (1) even used a custom Nintendo monitor. The result of this custom hardware, combined with relatively expensive parts, made arcade piracy an non-issue.  Piracy here refers to the production of knock-off equipment for which the original developers are no t compensated. 
Of course all of this custom hardware is expensive to produce and manufacture. Game developers early on moved to more standard systems, where the only difference between to machines might be the art painted on the side and the game code stored in the machines non-volatile memory. 
One of the first systems of this nature to be developed was the Capcom Play System. It was the introduction of this system, along with the games that ran on them, which ultimately allowed Capcom to be one of the largest producers of arcade machines in the world. The side effect of this was rampant piracy. By using commodity computer parts in a widely deployed standard fasion, Capcom allowed third parties to develop their own knock-off arcade machines which were identical to those produced by Capcom.  The only thing that knock-off manufactorers couldn’t produce themselves was the actual game code developed by Capcom. For this they required access to an original arcade machine. By copying the code off of that machine, the knock-off were able to run Capcom developed arcade games. 
Capcom seemed to have realized the risk of this in the development of the system and worked to some extent on mitigation.  For this purpose the code in the arcade memory was obfuscated to prevent casual copying. The low-order 8 bits of each 16-bit word are XOR-ed according to the following schedule. 
		/* only the low 8 bits of each word are encrypted */
		src = rom[A/2];
		dst = src & 0xff00;
		if ( src & 0x01) dst ^= 0x04;
		if ( src & 0x02) dst ^= 0x21;
		if ( src & 0x04) dst ^= 0x01;
		if (~src & 0x08) dst ^= 0x50;
		if ( src & 0x10) dst ^= 0x40;
		if ( src & 0x20) dst ^= 0x06;
		if ( src & 0x40) dst ^= 0x08;
		if (~src & 0x80) dst ^= 0x88;
This obfuscation technique was completely ineffective in securing the CPS against bootleg development. Once this XOR schedule was identified, it became completely trivial to copy the game code from legitimate hardware. To combat this Capcom developed the CPS-2, which ultimately ended up being significantly more successful in preventing knock-offs then the CPS-1 was. 
The Capcom Play System 2  (CPS2) 
The Capcom Play System 2 was introduced in 1993 as the follow on the CPS-1. It introduced novel encryption techniques that weren’t successfully circumvented for the next 10 years. The CPS-2 in many ways is identical to the CPS-1. It used an A and B board, where the A board was indentical across arcade hardware and the B board contained the actual game code. What was unique about the CPS-2 was the introduction of  a security system to prevent 
(1) http://www.romkeeper.com/romdkong.html

